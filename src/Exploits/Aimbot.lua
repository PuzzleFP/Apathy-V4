SetScriptContext("Aimbot")

local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")

local Client = Players.LocalPlayer

local Aimbot = {}

local function GetNearestPlayerToMouse()
    local CurrentClosestDistance = math.huge 
    local CurrentClosestPlayer

    for _, Player in ipairs(Players:GetPlayers()) do 
        if Player == Client then 
            continue 
        end 

        local HasCharacter = Player.Character

        if not HasCharacter then 
            continue 
        end 

        local HasHumanoid = HasCharacter:FindFirstChildOfClass("Humanoid")

        if not HasHumanoid or HasHumanoid.Health <= 0 then 
            continue 
        end 

        local MouseLocation = UserInputService:GetMouseLocation()

        local NewRay, OnScreen = workspace.CurrentCamera:WorldToViewportPoint(HasCharacter.Head.Position)
        if OnScreen then 
            local Distance = (Vector2.new(NewRay.X, NewRay.Y) - MouseLocation).Magnitude

            if Distance < CurrentClosestDistance then 
                CurrentClosestDistance = Distance 
                CurrentClosestPlayer = Player
            end 

        end 
    end 

    return CurrentClosestPlayer, CurrentClosestDistance
end 

return Aimbot 
